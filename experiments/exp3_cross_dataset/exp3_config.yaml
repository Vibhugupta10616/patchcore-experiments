# Experiment 3: Feature Fusion Strategy Ablation
# Configuration for comparing different feature fusion strategies

experiment:
  name: "feature_fusion_ablation"
  description: "Compare different feature fusion strategies"
  fusion_strategies:
    - "single_layer"      # Use only one layer
    - "concatenation"     # Concatenate all layers
    - "weighted"          # Weighted combination
    - "adaptive"          # Adaptive weights based on variance
  categories:
    - "bottle"
    - "cable"
    - "capsule"
    - "carpet"
    - "grid"
    - "hazelnut"
    - "leather"
    - "metal_nut"
    - "pill"
    - "screw"
    - "tile"
    - "toothbrush"
    - "transistor"
    - "wood"
    - "zipper"

backbone_config:
  name: "resnet50"
  pretrained: true
  feature_layers:
    - "layer2"
    - "layer3"
    - "layer4"

fusion_config:
  single_layer_idx: 2  # Use layer4 (index 2) for single-layer strategy
  weights: [0.2, 0.3, 0.5]  # Custom weights for weighted fusion

data_config:
  data_path: "../../data/mvtec_ad"
  image_size: 224
  batch_size: 32
  num_workers: 4

memory_config:
  method: "knn"
  n_neighbors: 5
  n_components: 256

output_path: "./results/exp3_feature_fusion"

device: "cuda"
seed: 42
verbose: true
